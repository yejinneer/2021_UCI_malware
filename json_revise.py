import json
file = open('malware_http.json')
pcap_data = json.load(file)

final_data = []

for n in range(0,80):
    tmp_data = dict()
    tmp_data["packetnum"] = pcap_data["packets"][n]["packetnum"]
    tmp_data["datetime"] = pcap_data["packets"][n]["datetime"]
    tmp_data["smac"] = pcap_data["packets"][n]["packetdata"]["smac"]
    tmp_data["dmac"] = pcap_data["packets"][n]["packetdata"]["dmac"]
    tmp_data["sip"] = pcap_data["packets"][n]["packetdata"]["sip"]
    tmp_data["dip"] = pcap_data["packets"][n]["packetdata"]["dip"]
    tmp_data["sport"] = pcap_data["packets"][n]["packetdata"]["sport"]
    tmp_data["dport"] = pcap_data["packets"][n]["packetdata"]["dport"]
    tmp_data["datalen"] = len(pcap_data["packets"][n]["packetdata"]["data"])
    tmp_str = pcap_data["packets"][n]["packetdata"]["data"]
    tmp_data["data_sliced"] = pcap_data["packets"][n]["packetdata"]["data"][:24]
    final_data.append(tmp_data)

with open('malware_http_final_revise.json', 'w', encoding='utf-8') as make_file:
    json.dump(final_data, make_file, indent="\t")

